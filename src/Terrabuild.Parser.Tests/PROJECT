extension @dotnet {
  defaults {
    configuration: $configuration
  }
}

extension @docker {
  defaults {
    configuration: $configuration
    image: "ghcr.io/magnusopera/dotnet-app"
  }
}

extension @toto {
    script "toto.fsx"
}

configuration {
  dependencies [ "../../libraries/shell-lib" ]
  outputs [ "dist" ]
  labels [ "app"
           "dotnet" ]
  parser "@dotnet"
}

target build {
  depends_on [ "dist" ]

  @dotnet build { }
}

target dist {
  @dotnet build { }
  @dotnet publish { }
}

target docker {
  @shell echo { message: trim("building project1 " + $configuration) }  
  @docker build { arguments: { config: "Release" } }                 
}
